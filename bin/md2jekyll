#!/usr/bin/env ruby

require 'md2jekyll'

module Md2Jekyll
  class Application
    MATCH_TITLE = %r{^# (.+)$}

    def initialize(argv)
      @filename = argv.first
    end

    def run
      markdown = File.read(@filename)
      title = markdown.match(MATCH_TITLE)[1]
      jekyll_body = markdown.gsub(MATCH_TITLE, '')
      jekyll_header = %Q(---
layout: post
title: "#{title}"
date: #{Time.now}
comments: true
categories:
---)
      tp = MdInc::TextProcessor.new
      puts tp.process(jekyll_header + jekyll_body)
    end
  end
end

if $0 == __FILE__
  Md2Jekyll::Application.new(ARGV).run
end
